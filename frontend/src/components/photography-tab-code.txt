// Photography handlers - INSERT INTO EditDashboard.jsx after certifications handlers

const handlePhotoFileChange = (e) => {
  const file = e.target.files[0];
  if (file) {
    setPhotoFile(file);
    const reader = new FileReader();
    reader.onloadend = () => {
      setPhotoPreview(reader.result);
    };
    reader.readAsDataURL(file);
  }
};

const uploadPhoto = async () => {
  if (!photoFile) {
    alert('Please select a photo');
    return;
  }

  setLoading(true);
  try {
    const { url, error: uploadError } = await uploadPhotoFile(photoFile);
    
    if (uploadError) {
      console.error('Upload error:', uploadError);
      alert('Error uploading photo: ' + uploadError.message);
      return;
    }

    const photoData = {
      image_url: url,
      title: editingPhoto?.title || '',
      description: editingPhoto?.description || '',
      display_order: photos.length
    };

    const { error } = await createPhoto(photoData);
    
    if (error) {
      console.error('Create error:', error);
      alert('Error saving photo: ' + error.message);
      return;
    }

    const { data: photosData } = await fetchPhotos();
    if (photosData) {
      setPhotos(photosData);
    }

    setEditingPhoto(null);
    setPhotoFile(null);
    setPhotoPreview(null);
    showSaveStatus('success');
  } catch (error) {
    console.error('Error uploading photo:', error);
    showSaveStatus('error');
  } finally {
    setLoading(false);
  }
};

const deletePhotoHandler = async (id) => {
  if (!confirm('Are you sure you want to delete this photo?')) return;

  setLoading(true);
  try {
    const { error } = await deletePhoto(id);
    if (error) throw error;

    const { data: photosData } = await fetchPhotos();
    if (photosData) {
      setPhotos(photosData);
    }

    showSaveStatus('success');
  } catch (error) {
    console.error('Error deleting photo:', error);
    showSaveStatus('error');
  } finally {
    setLoading(false);
  }
};

const movePhoto = (index, direction) => {
  const newPhotos = moveItem(photos, index, direction);
  setPhotos(newPhotos);
};

const savePhotosOrder = async () => {
  setLoading(true);
  try {
    for (let i = 0; i < photos.length; i++) {
      const photo = photos[i];
      if (photo.id) {
        const { error } = await updatePhoto(photo.id, { display_order: i });
        if (error) throw error;
      }
    }
    const { data: photosData } = await fetchPhotos();
    if (photosData) {
      setPhotos(photosData);
    }
    showSaveStatus('success');
  } catch (error) {
    console.error('Error saving photos order:', error);
    showSaveStatus('error');
  } finally {
    setLoading(false);
  }
};

const updatePhotoInfo = async (id, title, description) => {
  setLoading(true);
  try {
    const { error } = await updatePhoto(id, { title, description });
    if (error) throw error;

    const { data: photosData } = await fetchPhotos();
    if (photosData) {
      setPhotos(photosData);
    }

    showSaveStatus('success');
  } catch (error) {
    console.error('Error updating photo:', error);
    showSaveStatus('error');
  } finally {
    setLoading(false);
  }
};


// Photography Tab JSX - INSERT INTO EditDashboard.jsx in tab-content section

/* Photography Tab */
{activeTab === 'photography' && (
  <div className="edit-section">
    <h2>Photography</h2>
    <p className="section-description">Upload and manage photos for your photography page.</p>
    
    {/* Upload Section */}
    <div className="upload-section">
      <h3>Upload New Photo</h3>
      <div className="photo-upload-form">
        <div className="form-group">
          <label>Photo File</label>
          <input
            type="file"
            accept="image/*"
            onChange={handlePhotoFileChange}
            className="file-input"
          />
          {photoPreview && (
            <div className="photo-preview">
              <img src={photoPreview} alt="Preview" />
            </div>
          )}
        </div>

        <div className="form-group">
          <label>Title (Optional)</label>
          <input
            type="text"
            value={editingPhoto?.title || ''}
            onChange={(e) => setEditingPhoto({ ...editingPhoto, title: e.target.value })}
            placeholder="Photo title"
          />
        </div>

        <div className="form-group">
          <label>Description (Optional)</label>
          <textarea
            value={editingPhoto?.description || ''}
            onChange={(e) => setEditingPhoto({ ...editingPhoto, description: e.target.value })}
            rows="3"
            placeholder="Photo description"
          />
        </div>

        <button 
          onClick={uploadPhoto} 
          disabled={loading || !photoFile} 
          className="save-button"
        >
          {loading ? 'Uploading...' : 'Upload Photo'}
        </button>
      </div>
    </div>

    <div className="section-divider"></div>

    {/* Photos List */}
    <div className="photos-management">
      <h3>Manage Photos ({photos.length})</h3>
      
      {photos.length > 1 && (
        <button onClick={savePhotosOrder} disabled={loading} className="save-button">
          Save Display Order
        </button>
      )}

      <div className="photos-grid">
        {photos.map((photo, index) => (
          <div key={photo.id} className="photo-item">
            <div className="photo-thumbnail">
              <img src={photo.image_url} alt={photo.title || 'Photo'} />
            </div>
            <div className="photo-item-content">
              {photo.title && <h4>{photo.title}</h4>}
              {photo.description && <p>{photo.description}</p>}
            </div>
            <div className="photo-item-actions">
              {photos.length > 1 && (
                <div className="reorder-buttons">
                  <button
                    onClick={() => movePhoto(index, 'up')}
                    disabled={index === 0}
                    className="move-btn"
                    title="Move up"
                  >
                    ↑
                  </button>
                  <button
                    onClick={() => movePhoto(index, 'down')}
                    disabled={index === photos.length - 1}
                    className="move-btn"
                    title="Move down"
                  >
                    ↓
                  </button>
                </div>
              )}
              <button
                onClick={() => deletePhotoHandler(photo.id)}
                className="delete-btn"
              >
                Delete
              </button>
            </div>
          </div>
        ))}
      </div>

      {photos.length === 0 && (
        <div className="no-items">
          <p>No photos uploaded yet. Upload your first photo above!</p>
        </div>
      )}
    </div>
  </div>
)}
